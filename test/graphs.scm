(let ((fold '<undefined>)) (let ((proc->vector '<undefined>)) (let ((vector-fold '<undefined>)) (let ((vector-map '<undefined>)) (let ((giota '<undefined>)) (let ((gnatural-fold '<undefined>)) (let ((gnatural-for-each '<undefined>)) (let ((natural-for-all? '<undefined>)) (let ((natural-there-exists? '<undefined>)) (let ((there-exists? '<undefined>)) (let ((fold-over-perm-tree '<undefined>)) (let ((make-minimal? '<undefined>)) (let ((cmp-next-vertex '<undefined>)) (let ((fold-over-rdg '<undefined>)) (let ((make-reach? '<undefined>)) (let ((run '<undefined>)) (let ((_$14 (set! fold (lambda (lst folder state ) (letrec ((_loop0 (lambda (lst state ) (let ((_p10 (null? lst))) (if _p10 state (let ((_p11 (cdr lst))) (let ((_p12 (car lst))) (let ((_p13 (folder _p12 state))) (_loop0 _p11 _p13))))))))) (_loop0 lst state)))))) (let ((_$22 (set! proc->vector (lambda (size f ) (let ((_p15 (zero? size))) (if _p15 (vector) (let ((_p16 (f 0))) (let ((x (make-vector size _p16))) (letrec ((loop (lambda (i ) (let ((_p17 (< i size))) (if _p17 (let ((_p18 (f i))) (let ((_$19 (vector-set! x i _p18))) (let ((_p20 (+ i 1))) (loop _p20)))) '<unspecified>))))) (let ((_$21 (loop 1))) x)))))))))) (let ((_$27 (set! vector-fold (lambda (vec folder state ) (let ((len (vector-length vec))) (letrec ((_loop1 (lambda (i state ) (let ((_p23 (= i len))) (if _p23 state (let ((_p24 (+ i 1))) (let ((_p25 (vector-ref vec i))) (let ((_p26 (folder _p25 state))) (_loop1 _p24 _p26))))))))) (_loop1 0 state))))))) (let ((_$30 (set! vector-map (lambda (vec proc ) (let ((_p28 (vector-length vec))) (proc->vector _p28 (lambda (i ) (let ((_p29 (vector-ref vec i))) (proc _p29))))))))) (let ((_$33 (set! giota (lambda (limit ) (letrec ((_-*- (lambda (limit res ) (let ((_p31 (zero? limit))) (if _p31 res (let ((limit (- limit 1))) (let ((_p32 (cons limit res))) (_-*- limit _p32)))))))) (_-*- limit '())))))) (let ((_$37 (set! gnatural-fold (lambda (limit folder state ) (letrec ((_loop2 (lambda (i state ) (let ((_p34 (= i limit))) (if _p34 state (let ((_p35 (+ i 1))) (let ((_p36 (folder i state))) (_loop2 _p35 _p36)))))))) (_loop2 0 state)))))) (let ((_$41 (set! gnatural-for-each (lambda (limit proc! ) (letrec ((_loop3 (lambda (i ) (let ((_p38 (= i limit))) (if _p38 '<undefined> (let ((_$39 (proc! i))) (let ((_p40 (+ i 1))) (_loop3 _p40)))))))) (_loop3 0)))))) (let ((_$44 (set! natural-for-all? (lambda (limit ok? ) (letrec ((_-*- (lambda (i ) (let ((_t4 (= i limit))) (if _t4 _t4 (let ((_p42 (ok? i))) (if _p42 (let ((_p43 (+ i 1))) (_-*- _p43)) #f))))))) (_-*- 0)))))) (let ((_$48 (set! natural-there-exists? (lambda (limit ok? ) (letrec ((_-*- (lambda (i ) (let ((_p45 (= i limit))) (let ((_p46 (not _p45))) (if _p46 (let ((_t5 (ok? i))) (if _t5 _t5 (let ((_p47 (+ i 1))) (_-*- _p47)))) #f)))))) (_-*- 0)))))) (let ((_$53 (set! there-exists? (lambda (lst ok? ) (letrec ((_-*- (lambda (lst ) (let ((_p49 (null? lst))) (let ((_p50 (not _p49))) (if _p50 (let ((_p51 (car lst))) (let ((_t6 (ok? _p51))) (if _t6 _t6 (let ((_p52 (cdr lst))) (_-*- _p52))))) #f)))))) (_-*- lst)))))) (let ((_$58 (set! fold-over-perm-tree (lambda (universe b-folder b-state t-folder t-state ) (letrec ((_-*- (lambda (universe b-state t-state accross ) (let ((_p54 (null? universe))) (if _p54 (t-folder b-state t-state accross) (letrec ((_-**- (lambda (in out t-state ) (let ((first (car in))) (let ((rest (cdr in))) (let ((_p55 (null? rest))) (let ((accross (if _p55 accross (lambda (new-t-state ) (let ((_p56 (cons first out))) (_-**- rest _p56 new-t-state)))))) (b-folder first b-state t-state (lambda (new-b-state new-t-state ) (let ((_p57 (fold out cons rest))) (_-*- _p57 new-b-state new-t-state accross))) accross)))))))) (_-**- universe '() t-state))))))) (_-*- universe b-state t-state (lambda (final-t-state ) final-t-state))))))) (let ((_$66 (set! make-minimal? (lambda (max-size ) (let ((_p59 (+ max-size 1))) (let ((iotas (proc->vector _p59 giota))) (let ((perm (make-vector max-size 0))) (lambda (size graph folder state ) (let ((_p60 (vector-ref iotas size))) (fold-over-perm-tree _p60 (lambda (perm-x x state deeper accross ) (let ((_t7 (cmp-next-vertex graph perm x perm-x)))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        (let ((_p61 (eqv? _t7 'less)))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          (if _p61 #f (let ((_p62 (eqv? _t7 'equal)))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           (if _p62 (let ((_$63 (vector-set! perm x perm-x))) (let ((_p64 (+ x 1)))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                (deeper _p64 state)))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               (let ((_p65 (eqv? _t7 'more)))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 (if _p65 (accross state) (error "???"))))))))) 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      (lambda (leaf-depth state accross ) (folder perm state accross)) state)))))))))) (let ((_$75 (set! cmp-next-vertex (lambda (graph perm x perm-x ) (let ((from-x (vector-ref graph x))) (let ((from-perm-x (vector-ref graph perm-x))) (letrec ((_-*- (lambda (y ) (let ((_p67 (= x y))) (if _p67 'equal (let ((x->y? (vector-ref from-x y))) (let ((perm-y (vector-ref perm y))) (let ((_p68 (vector-ref from-perm-x perm-y))) (let ((_p69 (eq? x->y? _p68))) (if _p69 (let ((_p70 (vector-ref graph y))) (let ((y->x? (vector-ref _p70 x))) (let ((_p71 (vector-ref graph perm-y))) (let ((_p72 (vector-ref _p71 perm-x))) (let ((_p73 (eq? y->x? _p72))) (if _p73 (let ((_p74 (+ y 1))) (_-*- _p74)) (if y->x? 'less 'more))))))) (if x->y? 'less 'more))))))))))) (_-*- 0)))))))) (let ((_$134 (set! fold-over-rdg (lambda (size max-out folder state ) (let ((root (- size 1))) (let ((edge? (proc->vector size (lambda (from ) (make-vector size #f))))) (let ((edges (make-vector size '()))) (let ((out-degrees (make-vector size 0))) (let ((minimal-folder (make-minimal? root))) (let ((cont (lambda (perm state accross ) (accross #t)))) (let ((non-root-minimal? (lambda (size ) (minimal-folder size edge? cont #t)))) (let ((cont (lambda (perm state accross ) (let ((_t8 (cmp-next-vertex edge? perm root root))) (let ((_p76 (eqv? _t8 'less))) (if _p76 #f
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            (let ((vvv '(equal more)))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              (let ((_p77 (memv _t8 vvv)))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                (if _p77 (accross #t) (error "???")))))))))) (let ((root-minimal? (lambda () (minimal-folder root edge? cont #t)))) (letrec ((_-*- (lambda (vertex state ) (let ((_p78 (non-root-minimal? vertex))) (let ((_p79 (not _p78))) (if _p79 state (let ((_p80 (= vertex root))) (if _p80 (let ((reach? (make-reach? root edges))) (let ((from-root (vector-ref edge? root))) (letrec ((_-*- (lambda (v outs efr efrr state ) (let ((_t9 (= v root))) (let ((_p81 (if _t9 _t9 (= outs max-out)))) (let ((_p82 (not _p81))) (if _p82 (let ((_$83 (vector-set! from-root v #t))) (let ((_p84 (+ v 1))) (let ((_p85 (+ outs 1))) (let ((_p86 (cons v efr))) (let ((_p87 (vector-ref reach? v))) (let ((_p88 (cons _p87 efrr))) (let ((state (_-*- _p84 _p85 _p86 _p88 state))) (let ((_$89 (vector-set! from-root v #f))) (let ((_p90 (+ v 1))) (_-*- _p90 outs efr efrr state)))))))))) (let ((_p91 (natural-for-all? root (lambda (v ) (there-exists? efrr (lambda (r ) (vector-ref r v))))))) (let ((_p92 (if _p91 (root-minimal?) #f))) (if _p92 (let ((_$93 (vector-set! edges root efr))) (let ((_p94 (proc->vector size (lambda (i ) (vector-ref edges i))))) (folder _p94 state))) state)))))))))) (_-*- 0 0 '() '() state)))) (let ((from-vertex (vector-ref edge? vertex))) (letrec ((_-**- (lambda (sv outs state ) (let ((_p95 (= sv vertex))) (if _p95 (let ((_$96 (vector-set! out-degrees vertex outs))) (let ((_p97 (+ vertex 1))) (_-*- _p97 state))) (let ((_p98 (+ sv 1))) (let ((state (_-**- _p98 outs state))) (let ((from-sv (vector-ref edge? sv))) (let ((sv-out (vector-ref out-degrees sv))) (let ((_p99 (= sv-out max-out))) (let ((state (if _p99 state (let ((_p100 (vector-ref edges sv))) (let ((_p101 (cons vertex _p100))) (let ((_$102 (vector-set! edges sv _p101))) (let ((_$103 (vector-set! from-sv vertex #t))) (let ((_p104 (+ sv-out 1))) (let ((_$105 (vector-set! out-degrees sv _p104))) (let ((_p106 (+ sv 1))) (let ((state (_-**- _p106 outs state))) (let ((_p107 (= outs max-out))) (let ((state (if _p107 state (let ((_$108 (vector-set! from-vertex sv #t))) (let ((_p109 (vector-ref edges vertex))) (let ((_p110 (cons sv _p109))) (let ((_$111 (vector-set! edges vertex _p110))) (let ((_p112 (+ sv 1))) (let ((_p113 (+ outs 1))) (let ((state (_-**- _p112 _p113 state))) (let ((_p114 (vector-ref edges vertex))) (let ((_p115 (cdr _p114))) (let ((_$116 (vector-set! edges vertex _p115))) (let ((_$117 (vector-set! from-vertex sv #f))) state)))))))))))))) (let ((_$118 (vector-set! out-degrees sv sv-out))) (let ((_$119 (vector-set! from-sv vertex #f))) (let ((_p120 (vector-ref edges sv))) (let ((_p121 (cdr _p120))) (let ((_$122 (vector-set! edges sv _p121))) state)))))))))))))))))) (let ((_p123 (= outs max-out))) (if _p123 state (let ((_p124 (vector-ref edges vertex))) (let ((_p125 (cons sv _p124))) (let ((_$126 (vector-set! edges vertex _p125))) (let ((_$127 (vector-set! from-vertex sv #t))) (let ((_p128 (+ sv 1))) (let ((_p129 (+ outs 1))) (let ((state (_-**- _p128 _p129 state))) (let ((_$130 (vector-set! from-vertex sv #f))) (let ((_p131 (vector-ref edges vertex))) (let ((_p132 (cdr _p131))) (let ((_$133 (vector-set! edges vertex _p132))) state)))))))))))))))))))))))) (_-**- 0 0 state))))))))))) (_-*- 0 state))))))))))))))) (let ((_$141 (set! make-reach? (lambda (size vertex->out ) (let ((res (proc->vector size (lambda (v ) (let ((from-v (make-vector size #f))) (let ((_$135 (vector-set! from-v v #t))) (let ((_p136 (vector-ref vertex->out v))) (let ((_$137 (for-each (lambda (x ) (vector-set! from-v x #t)) _p136))) from-v)))))))) (let ((_$140 (gnatural-for-each size (lambda (m ) (let ((from-m (vector-ref res m))) (gnatural-for-each size (lambda (f ) (let ((from-f (vector-ref res f))) (let ((_p138 (vector-ref from-f m))) (if _p138 (gnatural-for-each size (lambda (t ) (let ((_p139 (vector-ref from-m t))) (if _p139 (vector-set! from-f t #t) '<unspecified>)))) '<unspecified>)))))))))) res)))))) (let ((_$142 (set! run (lambda (n ) (fold-over-rdg n 2 cons '()))))) (let ((_p143 (run 5))) (length _p143))))))))))))))))))))))))))))))))))



 
